(this.webpackJsonpphonebook=this.webpackJsonpphonebook||[]).push([[0],{20:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n(15),a=n.n(r),s=(n(20),n(6)),u=n(3),o=n(0),i=function(e){var t=e.field,n=e.handleField;return Object(o.jsx)("div",{children:Object(o.jsx)("input",{type:"text",value:t,onChange:n})})},l=function(e){var t=e.text,n=e.value,c=e.changeFn;return Object(o.jsxs)("div",{children:[t," ",Object(o.jsx)("input",{type:"text",value:n,onChange:c,required:!0})]})},d=n(4),f=n.n(d),j="/api/persons",b={getAll:function(){return f.a.get(j).then((function(e){return e.data}))},create:function(e){return f.a.post(j,e).then((function(e){return e.data}))},update:function(e,t){return f.a.put("".concat(j,"/").concat(e),t).then((function(e){return e.data}))},remove:function(e){return f.a.delete("".concat(j,"/").concat(e)).then((function(e){return e.data}))}},h=function(e){var t=e.person,n=e.setPersons,c=e.persons;return Object(o.jsxs)("div",{children:[t.name,"  ",t.number," ",Object(o.jsx)("button",{onClick:function(){window.confirm("Delete ".concat(t.name))&&(b.remove(t.id).then((function(e){return console.log(e)})),n(c.filter((function(e){return e.id!==t.id}))))},children:"delete"})]},t.name)},m=function(e){var t=e.filter,n=e.fn,c=e.array;return Object(o.jsx)("div",{children:t.map((function(e){return Object(o.jsx)(h,{setPersons:n,persons:c,person:e},e.name)}))})},O=function(e){var t=e.message;return null===t.text?null:Object(o.jsx)("div",{className:t.class,children:t.text})},x=function(){var e=Object(c.useState)([]),t=Object(u.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(""),d=Object(u.a)(a,2),f=d[0],j=d[1],h=Object(c.useState)(""),x=Object(u.a)(h,2),v=x[0],p=x[1],g=Object(c.useState)(""),w=Object(u.a)(g,2),F=w[0],y=w[1],k={text:null,class:"message"},S=Object(c.useState)(k),C=Object(u.a)(S,2),T=C[0],A=C[1];Object(c.useEffect)((function(){console.log("effect"),b.getAll().then((function(e){r(e)}))}),[]);var P=n.filter((function(e){return e.name.toLowerCase().includes(F.toLowerCase())}));return Object(o.jsxs)("div",{children:[Object(o.jsx)("h1",{children:"Phonebook with backend"}),Object(o.jsx)(O,{message:T}),Object(o.jsx)("h2",{children:"Filter from list"}),Object(o.jsx)(i,{field:F,handleField:function(e){y(e.target.value)}}),Object(o.jsx)("h2",{children:"Add a new number"}),Object(o.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t={name:f,number:v};if(n.some((function(e){return e.name===f}))){var c=n.find((function(e){return e.name===f}));if(window.confirm("Update  ".concat(c.name,"'s number"))){var a=Object(s.a)(Object(s.a)({},c),{},{number:v});b.update(a.id,a).then((function(e){console.log("update:",e);var t=n.map((function(e){return e.id===a.id?a:e}));r(t)})).catch((function(e){if(403===e.response.status){var t={text:e.response.data.error,class:"messageF"};A(t),setTimeout((function(){A(k)}),3e3)}else A({text:"the user was already deleted from server",class:"messageF"}),setTimeout((function(){A(k)}),3e3),r(n.filter((function(e){return e.id!==a.id})))}))}}else{var u={text:"user created succesfully",class:"message"};b.create(t).then((function(e){r(n.concat(e)),A(u),setTimeout((function(){A(k)}),3e3)})).catch((function(e){var t={text:e.response.data.error,class:"messageF"};A(t),setTimeout((function(){A(k)}),3e3)}))}j(""),p("")},children:[Object(o.jsxs)("div",{children:[Object(o.jsx)(l,{text:"name:",value:f,changeFn:function(e){j(e.target.value)}}),Object(o.jsx)(l,{text:"ph no:",value:v,changeFn:function(e){p(e.target.value)}})]}),Object(o.jsx)("div",{children:Object(o.jsx)("button",{type:"submit",children:"add"})})]}),Object(o.jsx)("h2",{children:"Numbers"}),Object(o.jsx)(m,{fn:r,array:n,filter:P})]})};a.a.render(Object(o.jsx)(x,{}),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.2808088e.chunk.js.map